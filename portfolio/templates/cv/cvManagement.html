{% extends "defaultTemplate.html" %}

{% block title %}<title>KJ Chow CV</title>{% endblock %}

{% block content %}
    <header class="major">
        <h2>CV</h2>
    </header>

    <!-- One -->
    <section id="cvUpload">
        <header class="major">
            <h2>Upload</h2>
        </header>
        <form action="/action_page.php">
            <input type="file" id="cvFile" name="cvFileUpload">
            <input type="submit">
        </form>
    </section>

    <section id="cvVersions">
        <header class="major">
            <h2>Versions</h2>
        </header>
        <table>
            <tr>
                <th>Date</th>
                <th>CV</th>
                <th>Active</th>
            </tr>

            <tr>
                <td>Date object</td>
                <td>
                    <section id="cv">
                        <div id="cvDiv">
                            <iframe id="cvKaiJie"></iframe>
                        </div>
                    </section>
                </td>
                <td>
                    <input type="radio" id="html" name="fav_language" value="HTML">
                    <label for="html"></label>
                </td>
            </tr>
        </table>
    </section>

    <!-- base64 to Blob -->
    <script>
        const b64toBlob = (b64Data, contentType = '', sliceSize = 512) => {
            const byteCharacters = atob(b64Data);
            const byteArrays = [];

            for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {
                const slice = byteCharacters.slice(offset, offset + sliceSize),
                    byteNumbers = new Array(slice.length);
                for (let i = 0; i < slice.length; i++) {
                    byteNumbers[i] = slice.charCodeAt(i);
                }
                const byteArray = new Uint8Array(byteNumbers);

                byteArrays.push(byteArray);
            }

            const blob = new Blob(byteArrays, {
                type: contentType
            });
            return blob;
        };
        const contentType = "application/pdf";
        var b64Data = "{{cv_encode}}";
        var blob = b64toBlob(b64Data, contentType);
        var blobUrl = URL.createObjectURL(blob);
        const iframeEle = document.getElementById("cvKaiJie");
        iframeEle.src = blobUrl;
    </script>
{% endblock %}